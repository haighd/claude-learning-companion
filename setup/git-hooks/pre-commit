#!/bin/bash
# CLC Pre-commit Hook - Enforces invariants before allowing commits
#
# Bypass with: git commit --no-verify

echo "üîç Running invariant checks..."
echo ""

# Run the check against the CLC repo
CLC_DIR="$HOME/.claude/clc"
if [ -f "$CLC_DIR/scripts/check-invariants.sh" ]; then
    "$CLC_DIR/scripts/check-invariants.sh" --project "$CLC_DIR"

    if [ $? -ne 0 ]; then
        echo ""
        echo "‚ùå Commit blocked. Fix the invariant violations above."
        echo "   (bypass with: git commit --no-verify)"
        exit 1
    fi
else
    echo "‚ö†Ô∏è Invariant check script not found, skipping checks"
fi

echo ""
echo "‚úÖ All checks passed. Proceeding with commit."
exit 0
